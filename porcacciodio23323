-- Versione 2.0: Air Walk attivabile con la pressione di un tasto (E)

local player = game.Players.LocalPlayer
local character = player.Character or player.CharacterAdded:Wait()
local humanoidRootPart = character:WaitForChild("HumanoidRootPart")
local UIS = game:GetService("UserInputService")
local RunService = game:GetService("RunService")

local AIRWALK_KEY = Enum.KeyCode.E -- Tasto per attivare/disattivare
local PLATFORM_OFFSET_Y = 3 -- La piattaforma si posiziona 3 stud sotto il giocatore

local airWalkOn = false
local platformY = 0
local platform = nil -- Variabile per la piattaforma

-- Funzione per creare e configurare la piattaforma
local function createPlatform()
    if platform and platform.Parent then
        return platform
    end
    
    local newPlatform = Instance.new("Part")
    newPlatform.Name = "AirWalkPlatform"
    newPlatform.Anchored = true
    newPlatform.Size = Vector3.new(5, 1, 5) -- Dimensione
    newPlatform.Transparency = 1 -- Invisibile
    newPlatform.CanCollide = false
    newPlatform.Parent = workspace
    
    platform = newPlatform
    return platform
end

-- Funzione principale per attivare/disattivare l'Air Walk
local function toggleAirWalk()
    airWalkOn = not airWalkOn

    if airWalkOn then
        -- Attivazione
        local currentPlatform = createPlatform()
        
        -- Calcola l'altezza fissa della piattaforma (sotto il giocatore)
        platformY = humanoidRootPart.Position.Y - PLATFORM_OFFSET_Y
        
        currentPlatform.CanCollide = true
        
        -- Stampa un messaggio (visibile solo nella console dell'exploit)
        warn("Air Walk Attivato alla Y: " .. string.format("%.3f", platformY))
    else
        -- Disattivazione
        if platform then
            platform.CanCollide = false
        end
        warn("Air Walk Disattivato")
    end
end

-- Loop di gioco (aggiorna la posizione della piattaforma ogni frame)
RunService.RenderStepped:Connect(function()
    if airWalkOn and platform and humanoidRootPart.Parent then
        -- Aggiorna la posizione X e Z della piattaforma, mantenendo l'altezza Y fissa
        platform.Position = Vector3.new(
            humanoidRootPart.Position.X,
            platformY,
            humanoidRootPart.Position.Z
        )
    end
end)

-- Gestione dell'Input (Pressione del tasto)
UIS.InputBegan:Connect(function(input, gameProcessedEvent)
    -- Controlla se è stato premuto il tasto desiderato e se non è un evento di sistema (es. la chat)
    if input.KeyCode == AIRWALK_KEY and not gameProcessedEvent then
        toggleAirWalk()
    end
end)

-- Pulizia quando il giocatore esce (opzionale)
player.AncestryChanged:Connect(function()
    if not player.Parent and platform then
        platform:Destroy()
    end
end)

-- Avviso: Come per tutti gli script di camminata aerea, questo è considerato un exploit
-- e potrebbe violare i termini di servizio di Roblox. Usalo a tuo rischio.
